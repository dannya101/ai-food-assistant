<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Food Assistant - NVIDIA Powered</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: #343541; 
            color: #ececf1;
            height: 100vh;
            overflow: hidden;
        }
        
        .app-container {
            display: flex;
            height: 100vh;
        }
        
        /* Main Chat Area */
        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            max-width: calc(100% - 320px);
        }
        
        .chat-header {
            background: #202123;
            padding: 1rem;
            border-bottom: 1px solid #444654;
            text-align: center;
        }
        
        .chat-header h1 {
            color: #ececf1;
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }
        
        .nvidia-badge { 
            background: #76b900; 
            color: white; 
            padding: 0.25rem 0.75rem; 
            border-radius: 15px; 
            font-size: 0.85rem;
            display: inline-block;
        }
        
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            background: #343541;
        }
        
        .message {
            margin-bottom: 1.5rem;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .message.user {
            background: #444654;
            padding: 1rem;
            border-radius: 8px;
            margin-left: 2rem;
        }
        
        .message.assistant {
            background: #343541;
            padding: 1rem;
            border-left: 3px solid #76b900;
            margin-right: 2rem;
        }
        
        .message-content {
            line-height: 1.6;
        }
        
        .typing-indicator {
            display: none;
            background: #343541;
            padding: 1rem;
            border-left: 3px solid #76b900;
            margin-right: 2rem;
            margin-bottom: 1.5rem;
        }
        
        .typing-dots {
            display: inline-flex;
            align-items: center;
        }
        
        .typing-dots span {
            height: 8px;
            width: 8px;
            background: #76b900;
            border-radius: 50%;
            margin: 0 2px;
            animation: typing 1.4s infinite ease-in-out;
        }
        
        .typing-dots span:nth-child(2) { animation-delay: 0.2s; }
        .typing-dots span:nth-child(3) { animation-delay: 0.4s; }
        
        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }
        
        .chat-input-container {
            background: #40414f;
            padding: 1rem;
            border-top: 1px solid #444654;
        }
        
        .chat-input-wrapper {
            max-width: 800px;
            margin: 0 auto;
            position: relative;
        }
        
        .chat-input {
            width: 100%;
            background: #40414f;
            border: 1px solid #565869;
            border-radius: 8px;
            padding: 12px 45px 12px 15px;
            color: #ececf1;
            font-size: 16px;
            resize: none;
            outline: none;
            min-height: 50px;
            max-height: 120px;
        }
        
        .chat-input:focus {
            border-color: #76b900;
        }
        
        .send-button {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            background: #76b900;
            border: none;
            border-radius: 6px;
            width: 32px;
            height: 32px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }
        
        .send-button:hover {
            background: #5a8f00;
        }
        
        .send-button:disabled {
            background: #444654;
            cursor: not-allowed;
        }
        
        /* Sidebar */
        .sidebar {
            width: 320px;
            background: #202123;
            border-left: 1px solid #444654;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        
        .sidebar-header {
            padding: 1rem;
            border-bottom: 1px solid #444654;
            background: #1a1b1f;
        }
        
        .sidebar-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .tab-button {
            flex: 1;
            padding: 0.5rem;
            background: #40414f;
            border: none;
            border-radius: 6px;
            color: #ececf1;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        .tab-button.active {
            background: #76b900;
        }
        
        .sidebar-content {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
        }
        
        .place-card {
            background: #40414f;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid #565869;
        }
        
        .place-card:hover {
            background: #4a4b5a;
            border-color: #76b900;
        }
        
        .place-card h3 {
            color: #ececf1;
            margin-bottom: 0.5rem;
            font-size: 1rem;
        }
        
        .place-card .info {
            color: #8e8ea0;
            font-size: 0.85rem;
            margin-bottom: 0.5rem;
        }
        
        .place-card .items {
            color: #8e8ea0;
            font-size: 0.8rem;
        }
        
        .quick-suggestions {
            margin-bottom: 1rem;
        }
        
        .suggestion-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        
        .suggestion-chip {
            background: #40414f;
            border: 1px solid #565869;
            border-radius: 15px;
            padding: 0.4rem 0.8rem;
            font-size: 0.8rem;
            color: #ececf1;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .suggestion-chip:hover {
            background: #76b900;
            border-color: #76b900;
        }
        
        .welcome-message {
            text-align: center;
            color: #8e8ea0;
            margin-top: 2rem;
            font-size: 1.1rem;
        }
        
        /* Mobile Responsive */
        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                right: -320px;
                top: 0;
                z-index: 1000;
                transition: right 0.3s ease;
            }
            
            .sidebar.open {
                right: 0;
            }
            
            .chat-container {
                max-width: 100%;
            }
            
            .mobile-sidebar-toggle {
                position: fixed;
                top: 1rem;
                right: 1rem;
                background: #76b900;
                border: none;
                border-radius: 50%;
                width: 50px;
                height: 50px;
                color: white;
                cursor: pointer;
                z-index: 1001;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Main Chat Interface -->
        <div class="chat-container">
            <div class="chat-header">
                <h1>üçï AI Food Assistant</h1>
                <span class="nvidia-badge">Powered by NVIDIA AI</span>
            </div>
            
            <div class="chat-messages" id="chatMessages">
                <div class="welcome-message">
                    <h2>üëã Welcome to your AI Food Assistant!</h2>
                    <p>Tell me what you're craving, and I'll help you find the perfect meal or recipe.</p>
                    
                    <div class="quick-suggestions">
                        <h3>Quick suggestions:</h3>
                        <div class="suggestion-chips">
                            <span class="suggestion-chip" onclick="sendSuggestion('I want something healthy for lunch')">ü•ó Healthy lunch</span>
                            <span class="suggestion-chip" onclick="sendSuggestion('I need a quick dinner recipe')">‚ö° Quick dinner</span>
                            <span class="suggestion-chip" onclick="sendSuggestion('What can I make with chicken?')">üçó Chicken recipes</span>
                            <span class="suggestion-chip" onclick="sendSuggestion('I want comfort food')">üç≤ Comfort food</span>
                            <span class="suggestion-chip" onclick="sendSuggestion('Show me vegetarian options')">üå± Vegetarian</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="typing-indicator" id="typingIndicator">
                <div class="typing-dots">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <span style="margin-left: 10px;">AI is thinking...</span>
            </div>
            
            <div class="chat-input-container">
                <div class="chat-input-wrapper">
                    <textarea 
                        id="chatInput" 
                        class="chat-input" 
                        placeholder="Tell me what you're craving..."
                        rows="1"
                    ></textarea>
                    <button id="sendButton" class="send-button" onclick="sendMessage()">
                        ‚û§
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Sidebar for Restaurants & Grocery Stores -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-tabs">
                    <button class="tab-button active" onclick="switchTab('restaurants')" id="restaurantTab">üè™ Restaurants</button>
                    <button class="tab-button" onclick="switchTab('grocery')" id="groceryTab">üõí Grocery</button>
                </div>
            </div>
            
            <div class="sidebar-content">
                <div id="restaurantContent">
                    <div class="place-card" onclick="selectPlace('mcdonalds')">
                        <h3>McDonald's</h3>
                        <div class="info">‚≠ê 4.2 ‚Ä¢ Fast Food ‚Ä¢ 15-25 min ‚Ä¢ $2.99 delivery</div>
                        <div class="items">Big Mac, McNuggets, Fries, McFlurry...</div>
                    </div>
                    
                    <div class="place-card" onclick="selectPlace('dominos')">
                        <h3>Domino's Pizza</h3>
                        <div class="info">‚≠ê 4.5 ‚Ä¢ Pizza ‚Ä¢ 20-30 min ‚Ä¢ $3.49 delivery</div>
                        <div class="items">Pepperoni Pizza, Wings, Breadsticks...</div>
                    </div>
                    
                    <div class="place-card" onclick="selectPlace('subway')">
                        <h3>Subway</h3>
                        <div class="info">‚≠ê 4.0 ‚Ä¢ Sandwiches ‚Ä¢ 10-20 min ‚Ä¢ $1.99 delivery</div>
                        <div class="items">Italian BMT, Chicken Teriyaki, Cookies...</div>
                    </div>
                </div>
                
                <div id="groceryContent" style="display: none;">
                    <div class="place-card" onclick="selectPlace('walmart')">
                        <h3>Walmart Grocery</h3>
                        <div class="info">‚≠ê 4.1 ‚Ä¢ Groceries ‚Ä¢ 45-60 min ‚Ä¢ $5.99 delivery</div>
                        <div class="items">Fresh produce, meat, dairy, pantry staples...</div>
                    </div>
                    
                    <div class="place-card" onclick="selectPlace('kroger')">
                        <h3>Kroger</h3>
                        <div class="info">‚≠ê 4.3 ‚Ä¢ Groceries ‚Ä¢ 30-45 min ‚Ä¢ $4.99 delivery</div>
                        <div class="items">Organic options, fresh ingredients, spices...</div>
                    </div>
                    
                    <div class="place-card" onclick="selectPlace('wholefood')">
                        <h3>Whole Foods</h3>
                        <div class="info">‚≠ê 4.6 ‚Ä¢ Organic ‚Ä¢ 35-50 min ‚Ä¢ $7.99 delivery</div>
                        <div class="items">Premium ingredients, organic produce...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Mobile sidebar toggle -->
    <button class="mobile-sidebar-toggle" onclick="toggleSidebar()" style="display: none;">‚ò∞</button>

    <script>
        let chatHistory = [];
        let currentPlace = null;
        let isTyping = false;

        // Chat functionality
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (message && !isTyping) {
                addMessage('user', message);
                input.value = '';
                handleAIResponse(message);
            }
        }

        function sendSuggestion(message) {
            addMessage('user', message);
            handleAIResponse(message);
        }

        function addMessage(type, content) {
            const messagesContainer = document.getElementById('chatMessages');
            const welcomeMessage = messagesContainer.querySelector('.welcome-message');
            
            if (welcomeMessage) {
                welcomeMessage.style.display = 'none';
            }

            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            messageDiv.innerHTML = `<div class="message-content">${content}</div>`;
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            chatHistory.push({ type, content });
        }

        async function handleAIResponse(userMessage) {
            showTypingIndicator();
            
            try {
                // Simulate AI processing time
                await new Promise(resolve => setTimeout(resolve, 1500 + Math.random() * 2000));
                
                const response = await fetch('/api/ai/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        message: userMessage,
                        history: chatHistory.slice(-10) // Last 10 messages for context
                    })
                });
                
                const data = await response.json();
                hideTypingIndicator();
                addMessage('assistant', data.response);
                
                // Handle any suggested actions
                if (data.suggestions) {
                    addSuggestionChips(data.suggestions);
                }
                
            } catch (error) {
                hideTypingIndicator();
                addMessage('assistant', getDefaultResponse(userMessage));
            }
        }

        function getDefaultResponse(userMessage) {
            const msg = userMessage.toLowerCase();
            
            if (msg.includes('healthy') || msg.includes('salad')) {
                return "ü•ó Great choice! For healthy options, I'd recommend checking out Subway for fresh sandwiches with lots of veggies, or you could get ingredients from Whole Foods to make a nutritious salad at home. What specific healthy foods do you enjoy?";
            } else if (msg.includes('quick') || msg.includes('fast')) {
                return "‚ö° For quick meals, McDonald's is your fastest option (15-25 min), or I can help you find a simple recipe that takes under 30 minutes to cook. Do you want to order out or cook something?";
            } else if (msg.includes('chicken')) {
                return "üçó Chicken is so versatile! You could get Chicken McNuggets from McDonald's, or grab some fresh chicken from Kroger and I can suggest recipes like chicken teriyaki, grilled chicken, or chicken stir-fry. What cooking style interests you?";
            } else if (msg.includes('comfort') || msg.includes('comfort food')) {
                return "üç≤ Comfort food is the best! Pizza from Domino's is always comforting, or for homemade comfort food, you could make mac and cheese, chicken soup, or grilled cheese. What brings you comfort?";
            } else if (msg.includes('vegetarian') || msg.includes('veggie')) {
                return "üå± Lots of great vegetarian options! Subway has veggie subs, or you can get fresh produce from Whole Foods for dishes like vegetable stir-fry, caprese salad, or pasta primavera. Any specific vegetables you love?";
            } else {
                return "I'd love to help you find the perfect meal! Tell me more about what you're in the mood for - are you looking to order from a restaurant or cook something at home? I can help you with both options using the places in the sidebar.";
            }
        }

        function addSuggestionChips(suggestions) {
            const messagesContainer = document.getElementById('chatMessages');
            const chipDiv = document.createElement('div');
            chipDiv.className = 'suggestion-chips';
            chipDiv.style.marginTop = '1rem';
            
            suggestions.forEach(suggestion => {
                const chip = document.createElement('span');
                chip.className = 'suggestion-chip';
                chip.textContent = suggestion;
                chip.onclick = () => sendSuggestion(suggestion);
                chipDiv.appendChild(chip);
            });
            
            messagesContainer.appendChild(chipDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function showTypingIndicator() {
            isTyping = true;
            document.getElementById('typingIndicator').style.display = 'block';
            document.getElementById('sendButton').disabled = true;
            
            const messagesContainer = document.getElementById('chatMessages');
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function hideTypingIndicator() {
            isTyping = false;
            document.getElementById('typingIndicator').style.display = 'none';
            document.getElementById('sendButton').disabled = false;
        }

        // Sidebar functionality
        function switchTab(tab) {
            const restaurantTab = document.getElementById('restaurantTab');
            const groceryTab = document.getElementById('groceryTab');
            const restaurantContent = document.getElementById('restaurantContent');
            const groceryContent = document.getElementById('groceryContent');
            
            if (tab === 'restaurants') {
                restaurantTab.classList.add('active');
                groceryTab.classList.remove('active');
                restaurantContent.style.display = 'block';
                groceryContent.style.display = 'none';
            } else {
                groceryTab.classList.add('active');
                restaurantTab.classList.remove('active');
                groceryContent.style.display = 'block';
                restaurantContent.style.display = 'none';
            }
        }

        function selectPlace(placeId) {
            currentPlace = placeId;
            const placeName = getPlaceName(placeId);
            
            addMessage('assistant', `Great choice! I see you're interested in ${placeName}. What would you like to know about their menu or would you like me to help you place an order?`);
        }

        function getPlaceName(placeId) {
            const places = {
                'mcdonalds': "McDonald's",
                'dominos': "Domino's Pizza",
                'subway': 'Subway',
                'walmart': 'Walmart Grocery',
                'kroger': 'Kroger',
                'wholefood': 'Whole Foods'
            };
            return places[placeId] || placeId;
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('open');
        }

        // Input handling
        document.getElementById('chatInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        // Auto-resize textarea
        document.getElementById('chatInput').addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = Math.min(this.scrollHeight, 120) + 'px';
        });

        // Mobile responsiveness
        function checkMobile() {
            const mobileToggle = document.querySelector('.mobile-sidebar-toggle');
            if (window.innerWidth <= 768) {
                mobileToggle.style.display = 'block';
            } else {
                mobileToggle.style.display = 'none';
                document.getElementById('sidebar').classList.remove('open');
            }
        }

        window.addEventListener('resize', checkMobile);
        document.addEventListener('DOMContentLoaded', checkMobile);
    </script>
</body>
</html>